version: 2.1

jobs:
  build:
   docker:
    - image: cimg/base:2021.04
      auth:
         username: $DOCKER_USERNAME
         password: $DOCKER_PASSWORD
   steps:
        - run: echo "First Step"
        - checkout
        - setup_remote_docker:
            version: 20.10.14
            docker_layer_caching: true
        - run: 
           name: build
           command: |
             docker build -t jalak777/simpleweb:v4 .
             docker ps -a
             echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin
             docker push jalak777/simpleweb:v4
